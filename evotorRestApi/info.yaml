version: 1.0.5
title: API Эвотор
description: |
   # О REST API Эвотор
   Пользователи платформы Эвотор могут расширить базовую функциональность смарт-терминала с помощью интеграции со сторонними сервисами. Для пользователя, интеграция происходит с помощью приложений, доступных в Магазине Эвотор.
   После интеграции, сторонние сервисы могут взаимодействовать с данными пользователей платформы с помощью HTTP-запросов.
   Кроме обращений к REST API облака, сторонние сервисы могут подписаться на вебхуки облака Эвотор
   ## Вебхуки
   Вебхуки - события, которые рассылает облако Эвотор на заданные адреса. Чтобы подписать сторонний сервис на вебхуки облака Эвотор, при создании приложения, на вкладке **Интеграция** требуется указать соответствующие веб-адреса.
   Облако Эвотор поддерживает два вида вебхуков:

     * Уведомления. Облако гарантирует доставку вебхуков этого типа, но не требует подтверждения действия от стороннего сервиса.
     * Запросы. Облако гарантирует доставку вебхуков этого типа и ожидает подтверждения действия от стороннего сервиса. Например, при регистрации новой или авторизации существующей учётной записи.

   # Авторизация
   Запросы стороннего сервера к REST API, облако Эвотор авторизует с помощью **токена приложения**. Вебхуки облака сторонний сервис авторизует с помощью **токена стороннего сервиса** и **токена пользователя**.

   ## Токен приложения
   Все запросы к REST API облака Эвотор, должны содержать HTTP-заголовок `X-Authorization`, в котором требуется указать **токен приложения**. Токен можно получить одним из следующих способов:

   * В GET-параметре `token` веб-адреса iframe-приложения:
       ```HTML
       https://partner.org/#/?uid=01-000000000011111&token=string
       ```

   * В Личном кабинете пользователя Эвотор, в разделе **Настройки** приложения.
     ![Токен для интеграции с 1с](images/api-key.png)

   * С помощью вебхука **[POST] Передача токена приложения**. Для этого сторонний сервис должен поддерживать адрес `http://partner.ru/api/v1/user/token`.

   ## Токен стороннего сервиса
   **Токен стороннего сервиса** необходим для авторизации вебхуков-запросов. В зависимости от способа авторизации, вебхуки-запросы к стороннему сервису содержат заголовок `Authorization` с типом `Basic` или `Bearer`:

   * Если сторонний сервис поддерживает авторизацию с типом `Basic`, в Эвотор требуется предоставить имя пользователя и пароль в формате `username:password`.

   * Если сторонний сервис поддерживает авторизацию с типом `Bearer`, в Эвотор требуется предоставить токен в формате `string`.

   В ответ на вебхуки **[POST] Авторизация пользователя**, **[POST] Регистрация учётной записи** и **[POST] Активация / деактивация тарифа**, сторонний сервис сообщает облаку Эвотор **токен пользователя**, который необходим, чтобы авторизовать все остальные вебхуки Эвотора.

   Сторонний веб-сервис также может обращаться в облако Эвотор за дополнительной информацией. Токен для авторизации таких запросов Эвотор передаёт в вебхуке  **[POST] Передача токена приложения**.
